<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Haven — Orientation</title>
  <meta name="description" content="A single screen to answer: what's important now?" />
  <style>
    :root{
      --bg:#0f1110;
      --fg:#e8e9e6;
      --muted:#a3a6a0;
      --rule:#2a2d2a;
      --card:#121513;
      --focus:#e8e9e6;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--fg);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      line-height:1.5;
      letter-spacing:.01em;
    }
    .wrap{
      max-width:920px;
      margin:0 auto;
      padding:32px 18px 56px;
    }
    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      margin-bottom:22px;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .brand .kicker{
      color:var(--muted);
      letter-spacing:.14em;
      text-transform:uppercase;
      font-size:.8rem;
    }
    h1{
      margin:0;
      font-size:1.2rem;
      letter-spacing:.12em;
      text-transform:uppercase;
      font-weight:650;
    }
    .date{
      color:var(--muted);
      font-size:.9rem;
      white-space:nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns:1fr;
      gap:14px;
    }

    @media (min-width:860px){
      .grid{grid-template-columns:1.2fr .8fr;}
      .span2{grid-column:1 / -1;}
    }

    .card{
      background:var(--card);
      border:1px solid var(--rule);
      border-radius:14px;
      padding:16px;
      box-shadow:0 0 0 1px rgba(0,0,0,.05);
    }

    .label{
      color:var(--muted);
      letter-spacing:.14em;
      text-transform:uppercase;
      font-size:.76rem;
      margin:0 0 10px;
    }

    .field{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .input, .area{
      width:100%;
      background:transparent;
      color:var(--fg);
      border:1px solid var(--rule);
      border-radius:12px;
      padding:12px 12px;
      outline:none;
      font-size:1rem;
    }
    .input:focus, .area:focus{border-color:#3a3f3a}

    .area{min-height:110px; resize:vertical;}

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .pill{
      border:1px solid var(--rule);
      background:transparent;
      color:var(--muted);
      padding:8px 10px;
      border-radius:999px;
      font-size:.9rem;
      letter-spacing:.02em;
      cursor:pointer;
      user-select:none;
    }
    .pill[aria-pressed="true"]{
      color:var(--fg);
      border-color:#3a3f3a;
    }

    .mono{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      font-size:.9rem;
    }

    .hint{color:var(--muted); font-size:.9rem; margin-top:10px}

    .footer{
      margin-top:20px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      font-size:.9rem;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .btn{
      border:1px solid var(--rule);
      background:transparent;
      color:var(--fg);
      padding:9px 12px;
      border-radius:12px;
      font-size:.9rem;
      cursor:pointer;
    }
    .btn:hover{border-color:#3a3f3a}

    .quiet{
      color:var(--muted);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="kicker">Haven</div>
        <h1>Orientation Panel</h1>
      </div>
      <div class="date" id="today"></div>
    </header>

    <section class="grid">
      <div class="card">
        <div class="label">Now</div>
        <div class="field">
          <input class="input" id="now" placeholder="The single priority." />
          <div class="hint">If there are two, you are not oriented.</div>
        </div>
      </div>

      <div class="card">
        <div class="label">Energy</div>
        <div class="field">
          <div class="row" role="group" aria-label="Energy state">
            <button class="pill" data-energy="ignition" aria-pressed="false">Ignition</button>
            <button class="pill" data-energy="glide" aria-pressed="false">Glide</button>
            <button class="pill" data-energy="rest" aria-pressed="false">Rest</button>
          </div>
          <input class="input mono" id="energyNote" placeholder="One sentence: what your body is saying." />
          <div class="hint">Energy is data. Do not argue with it.</div>
        </div>
      </div>

      <div class="card">
        <div class="label">Direction</div>
        <div class="field">
          <textarea class="area" id="direction" placeholder="This season is for…"></textarea>
          <div class="hint">Keep it stable. Repetition is power.</div>
        </div>
      </div>

      <div class="card">
        <div class="label">Constraint</div>
        <div class="field">
          <textarea class="area" id="constraint" placeholder="What you are saying no to (for protection)."></textarea>
          <div class="hint">This is where the signal survives.</div>
        </div>
      </div>

      <div class="card span2">
        <div class="label">Next</div>
        <div class="field">
          <input class="input" id="next" placeholder="One concrete action today." />
          <div class="hint">Do this, then stop. Win = What’s Important Now.</div>
        </div>
      </div>
    </section>

    <div class="footer">
      <div class="actions">
        <button class="btn" id="clear">Clear</button>
        <button class="btn" id="export">Export</button>
        <span class="quiet">Autosaves locally.</span>
      </div>
      <div class="quiet">Stay present. Protect the signal.</div>
    </div>
  </div>

  <script>
    (function(){
      const $ = (id) => document.getElementById(id);
      const key = "haven.orientation.v1";

      const state = {
        now: "",
        energy: "",
        energyNote: "",
        direction: "",
        constraint: "",
        next: ""
      };

      const els = {
        now: $("now"),
        energyNote: $("energyNote"),
        direction: $("direction"),
        constraint: $("constraint"),
        next: $("next"),
        clear: $("clear"),
        export: $("export"),
        today: $("today"),
        pills: Array.from(document.querySelectorAll("[data-energy]"))
      };

      // Date header
      try{
        const d = new Date();
        els.today.textContent = d.toLocaleDateString(undefined, { weekday:"long", year:"numeric", month:"long", day:"numeric" });
      }catch(e){ els.today.textContent = ""; }

      const setEnergy = (value) => {
        state.energy = value;
        els.pills.forEach(btn => {
          const on = btn.getAttribute("data-energy") === value;
          btn.setAttribute("aria-pressed", on ? "true" : "false");
        });
        save();
      };

      const save = () => {
        state.now = els.now.value;
        state.energyNote = els.energyNote.value;
        state.direction = els.direction.value;
        state.constraint = els.constraint.value;
        state.next = els.next.value;
        try{ localStorage.setItem(key, JSON.stringify(state)); }catch(e){}
      };

      const load = () => {
        try{
          const raw = localStorage.getItem(key);
          if(!raw) return;
          const data = JSON.parse(raw);
          Object.assign(state, data);
          els.now.value = state.now || "";
          els.energyNote.value = state.energyNote || "";
          els.direction.value = state.direction || "";
          els.constraint.value = state.constraint || "";
          els.next.value = state.next || "";
          setEnergy(state.energy || "");
        }catch(e){}
      };

      const exportText = () => {
        const d = els.today.textContent || "";
        const lines = [
          "HAVEN — ORIENTATION",
          d,
          "",
          "NOW: " + (els.now.value || ""),
          "ENERGY: " + (state.energy || ""),
          "ENERGY NOTE: " + (els.energyNote.value || ""),
          "",
          "DIRECTION:",
          (els.direction.value || ""),
          "",
          "CONSTRAINT:",
          (els.constraint.value || ""),
          "",
          "NEXT: " + (els.next.value || ""),
          "",
          "Stay present. Protect the signal."
        ].join("\n");

        // Copy to clipboard if possible
        if(navigator.clipboard && navigator.clipboard.writeText){
          navigator.clipboard.writeText(lines).catch(() => {});
        }

        // Also download as .txt
        try{
          const blob = new Blob([lines], { type: "text/plain" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "haven-orientation.txt";
          document.body.appendChild(a);
          a.click();
          a.remove();
          URL.revokeObjectURL(url);
        }catch(e){}
      };

      // Wire inputs
      [els.now, els.energyNote, els.direction, els.constraint, els.next].forEach(el => {
        el.addEventListener("input", save);
      });

      els.pills.forEach(btn => {
        btn.addEventListener("click", () => {
          const v = btn.getAttribute("data-energy") || "";
          setEnergy(state.energy === v ? "" : v);
        });
      });

      els.clear.addEventListener("click", () => {
        els.now.value = "";
        els.energyNote.value = "";
        els.direction.value = "";
        els.constraint.value = "";
        els.next.value = "";
        setEnergy("");
        save();
      });

      els.export.addEventListener("click", () => exportText());

      load();
    })();
  </script>
</body>
</html>
