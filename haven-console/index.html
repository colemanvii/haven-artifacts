<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Haven Console</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    /* ---------- Base ---------- */
    :root{
      --radius: 18px;
      --pad: 22px;
      --max: 1040px;

      --bg: #0b0f0c;
      --bg2:#0f1511;
      --card:#0f1511cc;
      --line:#243027;
      --text:#e7f2ea;
      --muted:#a3b7aa;
      --accent:#7ef2b6;
      --warn:#ffd37a;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --shadow: 0 10px 40px rgba(0,0,0,.35);
      --glow: radial-gradient(900px 600px at 22% 18%, rgba(126,242,182,.12) 0%, transparent 55%),
              radial-gradient(900px 600px at 75% 55%, rgba(255,211,122,.08) 0%, transparent 60%);
      --noise: none;
    }

    /* ---------- Skins ---------- */
    html[data-skin="monk"]{
      --bg: #f7f5ef;
      --bg2:#ffffff;
      --card:#ffffffcc;
      --line:#e6e0d4;
      --text:#141715;
      --muted:#5d6b62;
      --accent:#2f6f50;
      --warn:#8a5a12;
      --shadow: 0 18px 50px rgba(20,23,21,.10);
      --glow: radial-gradient(900px 600px at 22% 18%, rgba(47,111,80,.10) 0%, transparent 55%),
              radial-gradient(900px 600px at 75% 55%, rgba(138,90,18,.08) 0%, transparent 60%);
      --noise: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.06'/%3E%3C/svg%3E");
    }

    html[data-skin="dark"]{
      /* same as :root defaults */
    }

    /* ---------- Layout ---------- */
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: var(--sans);
      letter-spacing: .2px;
      color: var(--text);
      background:
        var(--glow),
        linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
      min-height:100vh;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image: var(--noise);
      mix-blend-mode:multiply;
      opacity:.85;
    }
    .wrap{
      max-width: var(--max);
      margin: 0 auto;
      padding: 30px 18px 60px;
      position:relative;
    }
    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      margin-bottom: 18px;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding: 18px 18px 16px;
      border-radius: var(--radius);
      background: var(--card);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      min-width: 320px;
    }
    .kicker{
      font-family: var(--mono);
      font-size: 12px;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: var(--muted);
    }
    h1{
      margin:0;
      font-size: 28px;
      line-height:1.15;
      font-weight: 680;
      letter-spacing:.2px;
    }
    .sub{
      color: var(--muted);
      font-size: 13px;
      line-height:1.4;
    }

    .controls{
      display:flex;
      align-items:center;
      gap:12px;
      padding: 14px 14px;
      border-radius: var(--radius);
      background: var(--card);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .label{
      font-family: var(--mono);
      font-size: 12px;
      letter-spacing: 1.6px;
      text-transform: uppercase;
      color: var(--muted);
      white-space:nowrap;
    }

    /* Toggle */
    .toggle{
      display:inline-flex;
      align-items:center;
      gap:10px;
      user-select:none;
    }
    .switch{
      width: 54px; height: 30px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      position:relative;
      cursor:pointer;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.04);
    }
    html[data-skin="monk"] .switch{ background: rgba(0,0,0,.03); }
    .knob{
      width: 24px; height: 24px;
      border-radius: 999px;
      position:absolute; top: 50%; left: 3px;
      transform: translateY(-50%);
      background: var(--text);
      opacity: .9;
      transition: left .18s ease;
    }
    .switch[data-on="1"] .knob{ left: 27px; }
    .hint{
      font-size: 12px;
      color: var(--muted);
    }

    /* Grid */
    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 16px;
      margin-top: 14px;
    }
    @media (max-width: 900px){
      .topbar{ flex-direction:column; }
      .brand{ min-width: unset; width:100%; }
      .controls{ width:100%; justify-content:space-between; }
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border-radius: var(--radius);
      background: var(--card);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      padding: var(--pad);
    }
    .card h2{
      margin:0 0 10px;
      font-family: var(--mono);
      font-size: 12px;
      letter-spacing: 2.2px;
      text-transform: uppercase;
      color: var(--muted);
    }
    .big{
      font-size: 20px;
      line-height:1.25;
      font-weight: 650;
      margin: 0 0 6px;
    }
    .small{
      font-size: 13px;
      line-height:1.45;
      color: var(--muted);
      margin:0 0 14px;
    }

    .pillrow{ display:flex; gap:10px; flex-wrap:wrap; }
    .pill{
      font-family: var(--mono);
      font-size: 12px;
      color: var(--text);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding: 10px 12px;
      border-radius: 999px;
      max-width: 100%;
    }
    html[data-skin="monk"] .pill{ background: rgba(0,0,0,.03); }
    .pill strong{ color: var(--accent); font-weight: 700; }

    .checklist{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top: 8px;
    }
    .item{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding: 10px 10px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: 14px;
    }
    html[data-skin="monk"] .item{ background: rgba(0,0,0,.025); }
    .box{
      width:18px;height:18px;border-radius:6px;
      border:1px solid var(--line);
      background: transparent;
      flex:0 0 auto;
      margin-top:2px;
      cursor:pointer;
      position:relative;
    }
    .box[data-done="1"]{
      background: rgba(126,242,182,.18);
      border-color: rgba(126,242,182,.45);
    }
    html[data-skin="monk"] .box[data-done="1"]{
      background: rgba(47,111,80,.14);
      border-color: rgba(47,111,80,.35);
    }
    .box[data-done="1"]::after{
      content:"";
      position:absolute;
      left:5px; top:2px;
      width:6px; height:10px;
      border: 2px solid var(--accent);
      border-top:0;border-left:0;
      transform: rotate(45deg);
    }
    .itext{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .itext b{ font-weight:650; }
    .tag{
      font-family: var(--mono);
      font-size: 11px;
      color: var(--muted);
      letter-spacing:1px;
    }

    .footer{
      margin-top: 18px;
      text-align:center;
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: var(--muted);
      opacity:.9;
    }
    .quote{
      color: var(--muted);
      text-transform:none;
      letter-spacing:.6px;
    }
    a{ color: var(--accent); text-decoration: none; }
    a:hover{ text-decoration: underline; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="kicker">HAVEN / CONSOLE</div>
        <h1 id="todayTitle">Today — </h1>
        <div class="sub" id="todaySub">Timezone: — • Mode: steady wattage • Law: “I do not chase. I receive.”</div>
      </div>

      <div class="controls">
        <div>
          <div class="label">Skins</div>
          <div class="hint">Dark ↔ Monk (airy)</div>
        </div>

        <div class="toggle" title="Toggle skin">
          <div class="switch" id="skinSwitch" role="switch" aria-checked="false" tabindex="0" data-on="0">
            <div class="knob"></div>
          </div>
          <div class="label" id="skinName">Dark</div>
        </div>
      </div>
    </div>

    <div class="grid">
      <section class="card">
        <h2>Top Task</h2>
        <p class="big" contenteditable="true" spellcheck="false" data-key="topTask">
          One clean admin win that protects wattage.
        </p>
        <p class="small" contenteditable="true" spellcheck="false" data-key="topTaskNote">
          Keep it simple: do the one thing → close the loop → back to craft.
        </p>
        <div class="pillrow">
          <div class="pill" contenteditable="true" spellcheck="false" data-key="targetOutcome">
            <strong>Target outcome:</strong> loop closed + confirmation number
          </div>
          <div class="pill" contenteditable="true" spellcheck="false" data-key="script">
            <strong>Script:</strong> “I’m calling about a charge. I need a refund. Can you process that now and give me a confirmation number?”
          </div>
        </div>
      </section>

      <aside class="card">
        <h2>Daily Orientation</h2>
        <div class="checklist" id="orientation">
          <div class="item" data-id="ori1">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b>Ignition → Glide → Create</b>
              <span class="tag">Start narrow, then widen.</span>
            </div>
          </div>
          <div class="item" data-id="ori2">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b>Radical presence</b>
              <span class="tag">No inner split, no performance.</span>
            </div>
          </div>
          <div class="item" data-id="ori3">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b>Reset is allowed</b>
              <span class="tag">Mercies new every morning.</span>
            </div>
          </div>
        </div>

        <p class="small" style="margin-top:14px">
          <span style="color:var(--warn); font-weight:650;">Note:</span>
          <span contenteditable="true" spellcheck="false" data-key="note">
            Protect “creative wattage” today—one admin win, then back to craft.
          </span>
        </p>
      </aside>

      <section class="card">
        <h2>Open Loops on Your Plate</h2>
        <div class="checklist" id="loops">
          <!-- editable loop items -->
          <div class="item" data-id="loop1">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b contenteditable="true" spellcheck="false" data-key="loop1t">Write / shape the “Work is regulation / Flow is homeostasis” piece</b>
              <span class="tag" contenteditable="true" spellcheck="false" data-key="loop1tag">Writing • 333 radiant words</span>
            </div>
          </div>
          <div class="item" data-id="loop2">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b contenteditable="true" spellcheck="false" data-key="loop2t">Collect quotes/passages that echo this path (incl. Cormac)</b>
              <span class="tag" contenteditable="true" spellcheck="false" data-key="loop2tag">Study</span>
            </div>
          </div>
          <div class="item" data-id="loop3">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b contenteditable="true" spellcheck="false" data-key="loop3t">Orange tree drawing: emphasize the orangeness of the leaves</b>
              <span class="tag" contenteditable="true" spellcheck="false" data-key="loop3tag">Art</span>
            </div>
          </div>
        </div>

        <p class="small" style="margin-top:14px" contenteditable="true" spellcheck="false" data-key="loopsFooter">
          If you want this console to be strictly “action-only,” we can drop anything that isn’t concrete.
        </p>
      </section>

      <aside class="card">
        <h2>Today’s Console Rules</h2>
        <div class="checklist" id="rules">
          <div class="item" data-id="rule1">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b>One-thing bias</b>
              <span class="tag">Finish the admin loop first.</span>
            </div>
          </div>
          <div class="item" data-id="rule2">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b>Signal over spectacle</b>
              <span class="tag">Do the real thing; skip the noise.</span>
            </div>
          </div>
          <div class="item" data-id="rule3">
            <div class="box" data-done="0" aria-label="toggle"></div>
            <div class="itext">
              <b>Slowly, in your own way</b>
              <span class="tag">ゆっくりと、自分らしく</span>
            </div>
          </div>
        </div>
      </aside>
    </div>

    <div class="footer">
      HAVEN SYSTEMS • <span class="quote" contenteditable="true" spellcheck="false" data-key="footerQuote">“Rest protects wattage.”</span>
    </div>
  </div>

  <script>
    // ---------- Date header ----------
    (function initDate(){
      const now = new Date();
      const fmt = new Intl.DateTimeFormat(undefined, { weekday:"long", year:"numeric", month:"long", day:"numeric" });
      document.getElementById("todayTitle").textContent = "Today — " + fmt.format(now);
      try{
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || "Local";
        document.getElementById("todaySub").textContent =
          `Timezone: ${tz} • Mode: steady wattage • Law: “I do not chase. I receive.”`;
      }catch(e){}
    })();

    // ---------- Skin toggle (dark <-> monk) ----------
    const SKIN_KEY = "haven_skin";
    const html = document.documentElement;
    const sw = document.getElementById("skinSwitch");
    const skinName = document.getElementById("skinName");

    function setSkin(skin){
      html.setAttribute("data-skin", skin);
      const isMonk = skin === "monk";
      sw.dataset.on = isMonk ? "1" : "0";
      sw.setAttribute("aria-checked", String(isMonk));
      skinName.textContent = isMonk ? "Monk" : "Dark";
      localStorage.setItem(SKIN_KEY, skin);
    }

    const savedSkin = localStorage.getItem(SKIN_KEY) || "dark";
    setSkin(savedSkin);

    function toggleSkin(){
      const next = (html.getAttribute("data-skin") === "monk") ? "dark" : "monk";
      setSkin(next);
    }
    sw.addEventListener("click", toggleSkin);
    sw.addEventListener("keydown", (e)=>{ if(e.key==="Enter" || e.key===" "){ e.preventDefault(); toggleSkin(); } });

    // ---------- Checklist state ----------
    const DONE_KEY = "haven_done";
    const done = JSON.parse(localStorage.getItem(DONE_KEY) || "{}");

    function applyDone(){
      document.querySelectorAll(".item").forEach(it=>{
        const id = it.getAttribute("data-id");
        const box = it.querySelector(".box");
        const v = done[id] ? "1" : "0";
        box.dataset.done = v;
      });
    }
    applyDone();

    document.addEventListener("click", (e)=>{
      const box = e.target.closest(".box");
      if(!box) return;
      const item = box.closest(".item");
      const id = item.getAttribute("data-id");
      done[id] = !done[id];
      localStorage.setItem(DONE_KEY, JSON.stringify(done));
      applyDone();
    });

    // ---------- Inline editable persistence ----------
    const TEXT_KEY = "haven_text";
    const text = JSON.parse(localStorage.getItem(TEXT_KEY) || "{}");

    function loadText(){
      document.querySelectorAll("[data-key]").forEach(el=>{
        const k = el.getAttribute("data-key");
        if(text[k] != null) el.textContent = text[k];
      });
    }
    loadText();

    let saveTimer = null;
    document.addEventListener("input", (e)=>{
      const el = e.target.closest("[data-key]");
      if(!el) return;
      const k = el.getAttribute("data-key");
      text[k] = el.textContent;
      clearTimeout(saveTimer);
      saveTimer = setTimeout(()=> localStorage.setItem(TEXT_KEY, JSON.stringify(text)), 150);
    });
  </script>
</body>
</html>
